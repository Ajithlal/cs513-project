Primary Key Uniqueness
SELECT *
        FROM Menu
        GROUP BY id
        HAVING COUNT(*) > 1;

SELECT *
        FROM MenuItem 
        GROUP BY id
        HAVING COUNT(*) > 1;

SELECT *
        FROM MenuPage
        GROUP BY id
        HAVING COUNT(*) > 1;

SELECT *
        FROM Dish
        GROUP BY id
        HAVING COUNT(*) > 1;

Foreign Key Validity

SELECT *
    FROM MenuPage
    WHERE menu_id NOT IN (SELECT id FROM Menu);

SELECT *
    FROM MenuItem
    WHERE menu_page_id NOT IN (SELECT id FROM MenuPage);

SELECT *
    FROM MenuItem
    WHERE dish_id NOT IN (SELECT id FROM Dish);

Value Ranges

SELECT *
        FROM Menu
        WHERE page_count < 0 or dish_count < 0;

SELECT * 
        FROM Menu
        JOIN MenuPage
        ON Menu.id = MenuPage.menu_id
        GROUP BY menu_id HAVING COUNT(*) < Menu.page_count;

SELECT *
        FROM MenuItem
        WHERE created_at > updated_at;

SELECT *
    FROM MenuItem
    WHERE price IS NULL OR price = 0;

SELECT *
        FROM MenuItem
        WHERE price < 0;

SELECT MenuItem.*, Dish.highest_price, Dish.lowest_price
        FROM MenuItem
        JOIN Dish ON MenuItem.dish_id = Dish.id
        WHERE MenuItem.price > Dish.highest_price 
            OR MenuItem.price < Dish.lowest_price;

SELECT *
        FROM MenuPage
        WHERE page_number < 0 OR full_height < 0 OR full_width < 0;

SELECT *
        FROM Dish
        WHERE first_appeared > last_appeared;

SELECT *
        FROM Dish
        WHERE lowest_price > highest_price;

SELECT *
        FROM Dish
        WHERE menus_appeared < 0 
            OR times_appeared < 0 
            OR first_appeared < 0 
            OR last_appeared < 0
            OR lowest_price < 0 
            OR highest_price < 0;

Use Case:

SELECT * FROM Dish
        WHERE name LIKE '%coffee%'
            AND name NOT LIKE 'coffee';

SELECT 
        (CAST(strftime('%Y', Menu.Date) AS INTEGER) / 10) * 10 AS Decade,
        AVG(MenuItem.price) AS Avg_Coffee_Price
    FROM Menu
    JOIN MenuPage ON Menu.id = MenuPage.menu_id
    JOIN MenuItem ON MenuItem.menu_page_id = MenuPage.id
    JOIN Dish_clustered ON Dish_clustered.id = MenuItem.dish_id
    WHERE 
        Dish_clustered.name = 'coffee'
        AND Menu.currency = 'Dollars'
        AND Menu.currency_symbol = '$'
        AND CAST(strftime('%Y', Menu.Date) AS INTEGER) BETWEEN 1900 AND 2000
        AND MenuItem.price IS NOT NULL   
    GROUP BY Decade
    ORDER BY Decade;

Integrity Constraints:
IC-M1:
SELECT COUNT(*)
FROM Menu
WHERE id LIKE '%[^0-9]%' OR id IS NULL OR TRIM(id) = ''
   OR page_count LIKE '%[^0-9]%' OR page_count IS NULL OR TRIM(page_count) = ''
   OR dish_count LIKE '%[^0-9]%' OR dish_count IS NULL OR TRIM(dish_count) = '';

IC-M2:
SELECT COUNT(*)
FROM Menu
WHERE date NOT LIKE '____-__-__'
   OR date IS NULL
   OR NOT (SUBSTR(date, 5, 1) = '-' AND SUBSTR(date, 8, 1) = '-');

IC-M3:
SELECT COUNT(*)
        FROM Menu
        WHERE name LIKE '%  %' OR name LIKE '%[%' OR name LIKE '%]%' OR name != name
        OR event LIKE '%  %' OR event LIKE '%[%' OR event LIKE '%]%' OR event != event
        OR place LIKE '%  %' OR place LIKE '%[%' OR place LIKE '%]%' OR place != place;
IC-M4:
SELECT COUNT(*)
FROM Menu
WHERE name != TRIM(name)
   OR sponsor != TRIM(sponsor)
   OR event != TRIM(event)
   OR venue != TRIM(venue)
   OR place != TRIM(place)
   OR location != TRIM(location)
   OR location_type != TRIM(location_type);

IC-M5:
SELECT COUNT(*)
        FROM Menu
        WHERE place IS NULL OR place = '';

IC-MI1:
SELECT COUNT(*)
FROM MenuItem
WHERE price IS NULL OR TRIM(price) = '';

IC-MI2:
SELECT COUNT(*)
FROM MenuItem
WHERE id LIKE '%[^0-9]%'
   OR menu_page_id LIKE '%[^0-9]%'
   OR dish_id LIKE '%[^0-9]%';

IC-MI3:
SELECT COUNT(*)
        FROM MenuItem
        WHERE created_at NOT LIKE '____-__-__%' OR updated_at NOT LIKE '____-__-__%';

IC-MI4:
SELECT COUNT(*)
FROM MenuItem
WHERE id != TRIM(id)
   OR menu_page_id != TRIM(menu_page_id)
   OR price != TRIM(price)
   OR high_price != TRIM(high_price)
   OR dish_id != TRIM(dish_id)
   OR created_at != TRIM(created_at)
   OR updated_at != TRIM(updated_at)
   OR xpos != TRIM(xpos)
   OR ypos != TRIM(ypos);

IC-MP1:
SELECT COUNT(*)
FROM MenuPage
WHERE TRIM(id) LIKE '%[^0-9]%'
   OR TRIM(menu_id) LIKE '%[^0-9]%'
   OR TRIM(page_number) LIKE '%[^0-9]%'
   OR TRIM(full_height) LIKE '%[^0-9]%'
   OR TRIM(full_width) LIKE '%[^0-9]%';

IC-MP2:
SELECT COUNT(*)
FROM MenuPage
WHERE id != TRIM(id)
   OR menu_id != TRIM(menu_id)
   OR page_number != TRIM(page_number)
   OR full_height != TRIM(full_height)
   OR full_width != TRIM(full_width);

IC-D1:
SELECT COUNT(*)
FROM Dish
WHERE name IS NULL OR TRIM(name) = '';

IC-D2:
SELECT COUNT(*)
FROM Dish
WHERE name != LOWER(name)
   OR name != TRIM(name)
   OR name LIKE '%  %';
